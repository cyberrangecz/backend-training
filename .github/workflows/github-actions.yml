name: Training CI

on:
  push:
    branches-ignore:
      - master
  pull_request:
    branches:
      - master
  workflow_dispatch:
    inputs:
      confirm_action:
        description: "Type 'yes' if you want to publish and create a new tag"
        required: true
        default: "no"

jobs:
  # This will create docker image as well
  java_template:
    uses: cyberrangecz/actions-templates/.github/workflows/java_template.yml@master
    secrets:
      NVD_API: ${{ secrets.NVD_API }}
      OSS_INDEX_USER: ${{ secrets.OSS_INDEX_USER }}
      OSS_INDEX_TOKEN: ${{ secrets.OSS_INDEX_TOKEN }}
    with:
      MAVEN_CLI_OPTS: "-s etc/ci_settings.xml"
      IMAGE_NAME: "training"
      VERSION_PATH: "etc/ci_settings.xml"
      publish_and_tag: ${{ github.event.inputs.confirm_action }}
